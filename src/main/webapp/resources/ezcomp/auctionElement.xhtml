<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions">

    <!-- INTERFACE -->
    <cc:interface>
        <cc:attribute name="price" required="true"/>
        <cc:attribute name="title" required="true"/>
        <cc:attribute name="timeLeft" required="true"/>
        <cc:attribute name="pictureFilePath" required="true"/>
        <cc:attribute name="profile" required="true"/>  
        <cc:attribute name="showRating" required="true"/> 
        <cc:attribute name="deleteAuction" required="true"/>
        <cc:attribute name="userID" required="true"/>
        <cc:attribute name="auctionId" required="true" />
        <cc:attribute name="showBidButton" required="true" />
    </cc:interface>

    <!-- IMPLEMENTATION -->
    <cc:implementation>
        <div style="border: thin black solid">
            <b:modal id="amodal" title="Rate Product" styleClass="ratingModal" rendered="#{cc.attrs.showRating}">
                <b:well>
                    <h1><strong>Rate Product</strong></h1>
                    <h:form>
                        <h:outputText value="Rating: "/>
                        <p:rating value="#{rateProductManagedBean.feedback.rating}"/>
                        <b:inputText placeholder="Type a comment here..." value="#{rateProductManagedBean.feedback.comment}"></b:inputText>
                    </h:form>
                </b:well>
                <f:facet name="footer">
                    <b:button value="Close" dismiss="modal" onclick="$('.ratingModal').modal('hide');return false;"/>
                    <b:button value="Submit" look="primary" dismiss="modal" onclick="#{rateProductManagedBean.addFeedback(cc.attrs.auctionId)}"/>
                </f:facet>
            </b:modal>
            <b:modal id="amodal2" title="Delete Auction" styleClass="ratingModal" rendered="#{cc.attrs.deleteAuction}">
                <h3>Are you sure you want to delete this auction?</h3>
                <f:facet name="footer">
                    <b:button value="Close" dismiss="modal" onclick="$('.ratingModal').modal('hide');return false;"/>
                    <b:button value="Delete" look="primary" dismiss="modal" onclick="#{removeAuctionBean.removeAuction(cc.attrs.auctionId)}"/>
                </f:facet>
            </b:modal>
            <b:container fluid="true" >
                <b:row>
                    <b:column span="4">
                        <h:graphicImage id="productImage" 
                                        width="150" height="150" value="#{cc.attrs.pictureFilePath}"/>
                    </b:column>
                    <b:column span="8">
                        <b:row id="titleRow">
                            <h:outputText style="font-size: 20px; " value="#{cc.attrs.title}"></h:outputText>
                        </b:row>
                        <b:row id="priceAndTimeRow">
                            <b:column span="6">
                                <h:outputText id="priceText" value="#{cc.attrs.price} NOK">                                    
                                </h:outputText>
                            </b:column>
                            <b:column span="6">                                
                                <h:form rendered="#{auctionListManagedBean.getSecondsLeft(cc.attrs.auctionId)>0}"> 
                                    <b:label text="Time left "/>                                    
                                    <b:label text="Days: #{auctionListManagedBean.getDaysLeft(cc.attrs.auctionId)}"/>
                                    <pe:timer timeout="#{auctionListManagedBean.getSecondsLeft(cc.attrs.auctionId)}"  format="HH:mm:ss"/>
                                </h:form>
                            </b:column>
                        </b:row>
                        <b:row id="profileAndButtonRow">                            
                            <b:column span="6">
                                <h:link outcome="/GeneralViews/sellerCatalogue.xhtml">
                                     <h:graphicImage value="/resources/images/profileImage.png" width="50" 
                                                    height="50"/>
                                     <f:param name="uID" value="#{cc.attrs.userID}"></f:param>
                                </h:link>
                                <h:outputText value="#{cc.attrs.profile}"></h:outputText>            
                            </b:column>
                            <b:column span="6">
                                <b:button value="View" outcome="/GeneralViews/auctionDetail.xhtml?auctionId=#{cc.attrs.auctionId}" />                                
                                <b:button value="Rate" look="success" onclick="$('.ratingModal').modal();return false;" rendered="#{cc.attrs.showRating and renderFeedbackMB.renderFeedback(cc.attrs.auctionId)}"/>
                                <b:button value="Delete" look="danger" onclick="$('.ratingModal').modal();return false;" rendered="#{cc.attrs.deleteAuction}"/>
                            </b:column>
                        </b:row>
                    </b:column>
                </b:row>          
            </b:container>
        </div>
    </cc:implementation>
</html>